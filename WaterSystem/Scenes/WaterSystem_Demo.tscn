[gd_scene load_steps=26 format=3 uid="uid://di63xvgmuad5c"]

[ext_resource type="Script" uid="uid://b3ia51513jvcl" path="res://WaterSystem/Core/WaterManager.gd" id="1_manager"]
[ext_resource type="Script" uid="uid://cyg2vtwqa7k7v" path="res://WaterSystem/Core/WaterTestSpawner.gd" id="2_7s3q1"]
[ext_resource type="Script" uid="uid://bqc6df7l6f037" path="res://WaterSystem/Components/BuoyancyProvider.gd" id="2_buoyancy"]
[ext_resource type="Script" uid="uid://dndxysi04qdw" path="res://WaterSystem/Core/FreeLookCamera.gd" id="3_camera"]
[ext_resource type="Script" uid="uid://c3kmsvmxnjef1" path="res://WaterSystem/Core/WaterTestMover.gd" id="3_cp44o"]
[ext_resource type="Script" uid="uid://mshs5803cuhv" path="res://WaterSystem/Components/WaterInteractor3D.gd" id="4_q3oqb"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_demo"]
sky_horizon_color = Color(0.64625, 0.65575, 0.67075, 1)
ground_horizon_color = Color(0.64625, 0.65575, 0.67075, 1)

[sub_resource type="Sky" id="Sky_demo"]
sky_material = SubResource("ProceduralSkyMaterial_demo")

[sub_resource type="Environment" id="Environment_demo"]
background_mode = 2
sky = SubResource("Sky_demo")
tonemap_mode = 2
glow_enabled = true
fog_enabled = true
fog_light_color = Color(0.517647, 0.552941, 0.607843, 1)
fog_density = 0.001

[sub_resource type="FastNoiseLite" id="FastNoiseLite_6q4a7"]
seed = -99178781
frequency = 0.02

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_mtqsu"]
width = 256
height = 256
noise = SubResource("FastNoiseLite_6q4a7")
seamless = true

[sub_resource type="FastNoiseLite" id="FastNoiseLite_o4hkl"]
noise_type = 2
seed = -293989521
frequency = 0.05
fractal_type = 0

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_7s3q1"]
noise = SubResource("FastNoiseLite_o4hkl")
seamless = true

[sub_resource type="FastNoiseLite" id="FastNoiseLite_7s3q1"]
seed = 12345
frequency = 0.05

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_cp44o"]
noise = SubResource("FastNoiseLite_7s3q1")
seamless = true
as_normal_map = true

[sub_resource type="FastNoiseLite" id="FastNoiseLite_q3oqb"]
seed = 67890
frequency = 0.08

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_n4pnq"]
noise = SubResource("FastNoiseLite_q3oqb")
seamless = true
as_normal_map = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_n4pnq"]
albedo_color = Color(1, 0.5, 0, 1)

[sub_resource type="CapsuleMesh" id="CapsuleMesh_ci6bx"]

[sub_resource type="BoxMesh" id="BoxMesh_land"]
size = Vector3(10, 5, 10)

[sub_resource type="BoxShape3D" id="BoxShape3D_land"]
size = Vector3(10, 5, 10)

[sub_resource type="BoxMesh" id="BoxMesh_box"]
size = Vector3(2, 2, 2)

[sub_resource type="BoxShape3D" id="BoxShape3D_box"]
size = Vector3(2, 2, 2)

[sub_resource type="BoxMesh" id="BoxMesh_cliff"]
size = Vector3(5, 12, 5)

[sub_resource type="BoxShape3D" id="BoxShape3D_cliff"]
size = Vector3(5, 12, 5)

[node name="WaterSystem_Demo" type="Node3D"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_demo")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.866025, -0.433013, 0.25, 0, 0.5, 0.866025, -0.5, 0.75, -0.433013, 0, 0, 0)
shadow_enabled = true

[node name="WaterManager" type="Node3D" parent="." groups=["WaterSystem_Managers"]]
script = ExtResource("1_manager")
sea_size = Vector2(100, 100)
damping = 0.97
interact_strength = 200.0
interact_radius = 5.0
wind_strength = 0.0
wave_steepness = 0.0
wave_length = 0.0
wave_chaos = 0.0
foam_noise_tex = SubResource("NoiseTexture2D_mtqsu")
caustics_texture = SubResource("NoiseTexture2D_7s3q1")
normal_map1 = SubResource("NoiseTexture2D_cp44o")
normal_map2 = SubResource("NoiseTexture2D_n4pnq")

[node name="WaterTestSpawner_Instance" type="Node3D" parent="WaterManager"]
script = ExtResource("2_7s3q1")
movement_mode = 1
test_object_speed = 2.0

[node name="WaterTestObject" type="Node3D" parent="WaterManager/WaterTestSpawner_Instance"]
script = ExtResource("3_cp44o")
mode = 1
radius = 12.0

[node name="@MeshInstance3D@26054" type="MeshInstance3D" parent="WaterManager/WaterTestSpawner_Instance/WaterTestObject"]
material_override = SubResource("StandardMaterial3D_n4pnq")
mesh = SubResource("CapsuleMesh_ci6bx")

[node name="WaterInteractor3D" type="Node3D" parent="WaterManager/WaterTestSpawner_Instance/WaterTestObject" node_paths=PackedStringArray("water_manager")]
script = ExtResource("4_q3oqb")
water_manager = NodePath("../../..")

[node name="DemoIsland" type="StaticBody3D" parent="." groups=["WaterObstacles"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 15, -1, 0)

[node name="MeshInstance3D" type="MeshInstance3D" parent="DemoIsland"]
mesh = SubResource("BoxMesh_land")

[node name="CollisionShape3D" type="CollisionShape3D" parent="DemoIsland"]
shape = SubResource("BoxShape3D_land")

[node name="FloatingBox" type="RigidBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3.4367495, 0)
mass = 5.0

[node name="MeshInstance3D" type="MeshInstance3D" parent="FloatingBox"]
mesh = SubResource("BoxMesh_box")

[node name="CollisionShape3D" type="CollisionShape3D" parent="FloatingBox"]
shape = SubResource("BoxShape3D_box")

[node name="BuoyancyProvider" type="Node3D" parent="FloatingBox"]
script = ExtResource("2_buoyancy")
probe_points = Array[Vector3]([Vector3(1, 0, 1), Vector3(-1, 0, 1), Vector3(1, 0, -1), Vector3(-1, 0, -1), Vector3(0, 0, 0)])

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(0.7071068, -0.35355324, 0.6123725, 0, 0.86602557, 0.49999976, -0.7071068, -0.35355324, 0.6123725, 24.242167, 28.696148, 39.1805)
script = ExtResource("3_camera")

[node name="Cliff" type="StaticBody3D" parent="." groups=["WaterObstacles"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -15, 4, -10)

[node name="MeshInstance3D" type="MeshInstance3D" parent="Cliff"]
mesh = SubResource("BoxMesh_cliff")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Cliff"]
shape = SubResource("BoxShape3D_cliff")
