# 项目文件夹整理方案

## 📋 整理目标

1. 修复破图问题（节点路径错误）
2. 清理冗余文件（构建日志、临时文件）
3. 优化文件夹结构（按功能分类）
4. 统一文档组织

---

## ✅ 已修复的破图问题

### 1. GdOcean 节点路径错误

**问题：**
- `HybridOceanTest.tscn` 中使用了绝对路径（包含编辑器内部节点）
- 导致运行时找不到节点

**修复：**
- ✅ 改为相对路径：`NodePath("../OceanGenerator")`
- ✅ 代码中使用 `get_path_to()` 获取相对路径
- ✅ 修复变量遮蔽警告
- ✅ 修复未使用参数警告

---

## 📁 当前文件夹结构分析

### WaterSystem/ ✅ 已整理
```
WaterSystem/
├── Core/              # 核心逻辑
├── Physics/           # 物理系统
├── VFX/              # 视觉特效
├── Scenes/           # 场景文件
├── Docs/             # 文档
└── textures/         # 贴图
```
**状态：** ✅ 结构清晰，已整理

### Development/TechResearch/GdOcean/ ⚠️ 需要整理
```
GdOcean/
├── src/              # C++ 源代码 ✅
├── godot-cpp/        # 绑定库 ✅
├── *.tscn            # 场景文件（应分类）
├── *.gd              # 脚本（应分类）
├── build*.log        # 构建日志（应清理）
└── *.gdextension     # 配置（应分类）
```
**状态：** ⚠️ 文件混杂，需要整理

---

## 🎯 整理方案

### 方案 A：最小改动（推荐）

只清理构建日志，保持现有结构：

1. **创建 `build_logs/` 文件夹**
2. **移动所有日志文件**
   ```
   build*.log → build_logs/
   build*.txt → build_logs/
   error*.log → build_logs/
   ```
3. **添加 `.gitignore`**

**优点：** 快速、安全、不影响现有引用

---

### 方案 B：完整整理

按功能重新组织：

```
GdOcean/
├── src/                    # C++ 源代码
├── godot-cpp/              # 绑定库
├── Scenes/                 # 场景文件
│   ├── HybridOceanTest.tscn
│   └── OceanDemoScene.tscn
├── Scripts/                # GDScript
│   └── OceanTest.gd
├── Config/                 # 配置
│   ├── gd_ocean.gdextension
│   └── SConstruct
├── Build/                  # 构建相关
│   ├── build_logs/
│   └── bin/
├── Docs/                   # 文档
│   └── README.md
└── .gitignore
```

**优点：** 结构清晰，易于维护  
**缺点：** 需要更新所有路径引用

---

## 🧹 清理清单

### 可以删除的文件

- [ ] `build*.log` - 构建日志（可移动到 `build_logs/`）
- [ ] `build*.txt` - 构建日志
- [ ] `error*.log` - 错误日志
- [ ] `*.pdb` - 调试符号（如果不需要）
- [ ] `.sconsign.dblite` - SCons 缓存（会自动重建）

### 应该保留的文件

- ✅ `src/` - 源代码
- ✅ `godot-cpp/` - 绑定库
- ✅ `*.tscn` - 场景文件
- ✅ `*.gd` - 脚本文件
- ✅ `*.gdextension` - 扩展配置
- ✅ `SConstruct` - 构建脚本
- ✅ `README.md` - 文档

---

## 📝 .gitignore 建议

在 `GdOcean/` 目录下创建 `.gitignore`：

```gitignore
# 构建产物
bin/
*.pdb
*.exp
*.lib
*.obj
*.dll
*.so
*.dylib

# 构建日志
build*.log
build*.txt
error*.log
*.log

# SCons
.sconsign.dblite

# 临时文件
*.tmp
*.bak
*~

# Godot 缓存
.godot/
```

---

## 🚀 快速执行步骤

### 步骤 1：修复破图（已完成）

- ✅ 修复节点路径
- ✅ 修复变量遮蔽
- ✅ 修复未使用参数

### 步骤 2：清理构建日志（可选）

```powershell
# 在 GdOcean 目录下
mkdir build_logs
move build*.log build_logs\
move build*.txt build_logs\
move error*.log build_logs\
```

### 步骤 3：添加 .gitignore（推荐）

创建 `.gitignore` 文件，忽略构建产物和日志。

---

## 📊 整理效果对比

### 整理前
```
GdOcean/
├── 20+ 个构建日志文件
├── 场景、脚本、配置混在一起
└── 难以找到需要的文件
```

### 整理后
```
GdOcean/
├── src/              # 源代码
├── Scenes/           # 场景（清晰）
├── Scripts/          # 脚本（清晰）
├── Config/           # 配置（清晰）
├── build_logs/       # 日志（集中）
└── .gitignore        # 忽略规则
```

---

## ⚠️ 注意事项

1. **路径引用**
   - 移动文件后，需要更新场景中的脚本路径
   - 检查 `SConstruct` 中的路径引用

2. **构建脚本**
   - 如果移动了 `SConstruct`，需要更新工作目录
   - 或者使用相对路径

3. **GDExtension 配置**
   - `.gdextension` 文件中的路径可能需要更新

---

## ✅ 验证检查

整理后检查：

- [ ] 场景文件可以正常打开
- [ ] 脚本路径正确
- [ ] 构建可以正常进行
- [ ] 没有路径错误

---

**整理方案创建时间**：2024
**状态**：✅ 破图问题已修复，整理方案已提供
